# Silence Detection

Uses the [silencedetect filter](https://ffmpeg.org/ffmpeg-filters.html#silencedetect) from FFmpeg. This produces a text file containing data about periods of silence in an audio stream.

## FFmpeg command

Looks something like this:

```shell
ffmpeg -i myAudio.mp3 -af silencedetect=noise=0.01:duration=0.5,ametadata=mode=print:file=silence.txt -f null -
```

`-i myAudio.mp3` indicates the input audio file

`-af` is an alias for `-filter:a`, which creates an audio filtergraph (a chain of one or more filters).

<hr>

`silencedetect` is the name of a filter. Everything to the right of the `=` are options being set. The options are defined as `option_name=option_value`, and options are separated with colons (`:`). A comma (`,`) separates filters in the chain. This filter detects periods of silence.

By default this filter combines all audio channels when processing.

`noise=0.01` sets the noise tolerance to an amplitude ratio (in this example, `0.01`). Audio over this ratio will not be considered silence.

`duration=0.5` sets the amount of time (in [seconds](https://ffmpeg.org/ffmpeg-utils.html#time-duration-syntax)) the audio needs to be below the noise threshold to be reported as silence.

<hr>

`ametadata` is a filter that can capture the metadata generated by `silencedetect` filter. The `a` in `ametadata` means it is dealing with metadata on the audio streams.

The `mode=print` option prints the frame metadata available to the filter. The `file=silence.txt` specifies a file that the print output is written to.

<hr>

`-f null` indicates that FFmpeg will not attempt to encode or mux any output media, since all that is required from this command is the silence text data.

The final `-` means that any output the command does generate will be sent to stdout.

## Silence Metadata

An example of the text file that gets created by this filter:

```
frame:696  pts:801792  pts_time:18.1812
lavfi.silence_start=10.1878
frame:768  pts:884736  pts_time:20.062
lavfi.silence_end=20.0729
lavfi.silence_duration=9.88508
```

This Lambda function looks for lines beginning with `lavfi.silence_start` and `lavfi.silence_end` to construct ranges of silence based on timings, but as you can see there are other bits of information in the file that could be used.
